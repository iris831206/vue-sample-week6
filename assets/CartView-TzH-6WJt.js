import{S as h}from"./sweetalert2.all-5mWSKkjP.js";import{c as b}from"./cartStore-FLFL6EeO.js";import{_ as U,m as v,a as I,g as m,o as d,c,h as a,b as e,i as g,F as y,r as j,p as u,t as i,e as w,w as V,f as x,d as k}from"./index-pMnUd_Vm.js";var A={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"iris831206",BASE_URL:"/vue-sample-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:C,VITE_API_PATH:L}=A,B={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1,coupon_code:""}},methods:{...v(b,["addToCart"]),...v(b,["getCart"]),createOrder(){this.isLoading=!0;const o=`${C}/api/${L}/order`,s=this.form;this.$http.post(o,{data:s}).then(r=>{this.$router.push(`checkout/${r.data.orderId}`),this.$refs.form.resetForm(),this.getCart(),this.isLoading=!1}).catch(r=>{this.isLoading=!1,h.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500})})},addCouponCode(){const o=`${C}/api/${L}/coupon`,s={code:this.coupon_code};this.isLoading=!0,this.$http.post(o,{data:s}).then(r=>{h.fire({icon:"success",title:r.data.message,showConfirmButton:!1,timer:1500}),this.getCart(),this.isLoading=!1}).catch(r=>{this.isLoading=!1,h.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500})})}},computed:{...I(b,["carts","total","final_total"])},mounted(){this.getCart()}},F={class:"bg-light pt-5 pb-7"},P={class:"container"},R={class:"row justify-content-center flex-md-row flex-column-reverse"},N={class:"col-md-6"},q=e("div",{class:"position-relative m-4"},[e("div",{class:"progress",style:{height:"1px"}},[e("div",{class:"progress-bar",role:"progressbar",style:{width:"50%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),e("button",{type:"button",class:"position-absolute top-0 start-0 translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}},"1"),e("button",{type:"button",class:"position-absolute top-0 start-50 translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}},"2"),e("button",{type:"button",class:"position-absolute top-0 start-100 translate-middle btn btn-sm btn-secondary rounded-pill",style:{width:"2rem",height:"2rem"}},"3")],-1),D={class:"bg-white p-4"},M=e("h4",{class:"fw-bold mb-2"},"填寫收件資訊",-1),O={class:"my-5 row justify-content-center"},z={class:"mb-3"},H=e("label",{for:"email",class:"form-label"},"Email",-1),G={class:"mb-3"},J=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),K={class:"mb-3"},Q=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),W={class:"mb-3"},X=e("label",{for:"address",class:"form-label"},"收件人地址",-1),Y={class:"mb-3"},Z=e("label",{for:"message",class:"form-label"},"留言",-1),$=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-dark py-3 px-7 rounded-0"},"送出訂單")],-1),ee={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end"},te=e("i",{class:"fas fa-chevron-left me-2"},null,-1),se={class:"col-md-4"},oe={class:"border p-4 mb-4"},le=e("h4",{class:"mb-4"},"訂單明細",-1),ae=["src","alt"],ne={class:"w-100"},ie={class:"d-flex justify-content-between fw-bold"},re={class:"mb-0"},de={class:"mb-0"},ce={class:"d-flex justify-content-between"},me={class:"text-muted mb-0"},ue={key:0},pe={class:"text-success fs-5"},_e={key:1,class:"mb-0"},fe={key:1,class:"d-flex mt-3"},he=e("p",{class:"mb-0"},"目前沒有品項",-1),be=[he],ve=e("table",{class:"table mt-4 border-top border-bottom text-muted"},[e("tbody",null,[e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal text-end"},"總計")])])],-1),ge={class:"d-flex justify-content-between mt-4"},ye=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),we={key:2,class:"d-flex justify-content-between mt-4"},Ve=e("p",{class:"mb-0 h4 fw-bold"},null,-1),xe={class:"mb-0 h4 fw-bold text-success"},ke={key:0,class:"input-group mb-3 input-group-sm"},Ce={class:"input-group-append"};function Le(o,s,r,Ee,l,f){const E=m("VueLoading"),p=m("VeeField"),_=m("ErrorMessage"),T=m("VeeForm"),S=m("RouterLink");return d(),c(y,null,[a(E,{active:l.isLoading,"z-index":1060},null,8,["active"]),e("div",F,[e("div",P,[e("div",R,[e("div",N,[q,e("div",D,[M,e("div",O,[a(T,{ref:"form",onSubmit:f.createOrder},{default:g(({errors:t})=>[e("div",z,[H,a(p,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=n=>l.form.user.email=n)},null,8,["class","modelValue"]),a(_,{name:"email",class:"invalid-feedback"})]),e("div",G,[J,a(p,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=n=>l.form.user.name=n)},null,8,["class","modelValue"]),a(_,{name:"姓名",class:"invalid-feedback"})]),e("div",K,[Q,a(p,{id:"tel",name:"電話",type:"tel",class:u(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=n=>l.form.user.tel=n)},null,8,["class","modelValue"]),a(_,{name:"電話",class:"invalid-feedback"})]),e("div",W,[X,a(p,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=n=>l.form.user.address=n)},null,8,["class","modelValue"]),a(_,{name:"地址",class:"invalid-feedback"})]),e("div",Y,[Z,V(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=n=>l.form.message=n)},null,512),[[x,l.form.message]])]),$]),_:1},8,["onSubmit"])])]),e("div",ee,[a(S,{to:"/products",class:"text-dark mt-md-0 mt-3 text-decoration-none"},{default:g(()=>[te,k("繼續購物 ")]),_:1})])]),e("div",se,[e("div",oe,[le,o.carts&&o.carts.length>0?(d(!0),c(y,{key:0},j(o.carts,t=>(d(),c("div",{class:"d-flex mt-3",key:t.id},[e("img",{src:t.product.imageUrl,alt:t.product.title,class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,ae),e("div",ne,[e("div",ie,[e("p",re,i(t.product.title),1),e("p",de,"x"+i(t.qty),1)]),e("div",ce,[e("p",me,[e("small",null,"NT$"+i(t.product.price)+"/"+i(t.product.unit),1)]),o.final_total!==o.total?(d(),c("span",ue,[e("del",null,"原價"+i(t.total),1),k(" 折扣價"),e("span",pe,i(t.final_total)+"元",1)])):(d(),c("p",_e,"小計 "+i(t.total),1))])])]))),128)):(d(),c("div",fe,be)),ve,e("div",ge,[ye,e("p",{class:u(["mb-0 h4 fw-bold",{"text-decoration-line-through":o.final_total!==o.total}])},"NT $"+i(o.total)+" 元",3)]),o.final_total!==o.total?(d(),c("div",we,[Ve,e("p",xe,"折扣價 "+i(o.final_total)+" 元",1)])):w("",!0)]),o.carts&&o.carts.length>0?(d(),c("div",ke,[V(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=t=>l.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[x,l.coupon_code]]),e("div",Ce,[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[6]||(s[6]=(...t)=>f.addCouponCode&&f.addCouponCode(...t))}," 套用優惠碼 ")])])):w("",!0)])])])])],64)}const Ie=U(B,[["render",Le]]);export{Ie as default};
